# Homology Modeling

The pipeline creates homology models using the alignment generated by [HHpred](https://toolkit.tuebingen.mpg.de/tools/hhpred) and uses [MODELLER](https://salilab.org/modeller/) to generate the models.

The main script needed to reproduce the whole pipeline is documented in the `script_debug.bat` file (for Windows; the individual commands can be sequentially run on Linux too. Alternatively, can change the `.bat` file to `.sh` with appropriate header and removing all comments as well as changing the line endings from CRLF to LF).

The `log` files (`stdout` from the script) and summary of the MODELLER models (`model_summary.txt`) from the runs are kept in the run-specific folders in `output_data/modeller_run_logs` but all the generated models are not kept here (zenodo link?) due to size constraints. The final selected models used for IMP are to be found in the `output_data/selected_models`.

The query sequences for all HHpred searches are the full uniprot sequences of the respective molecules.

## Scripts

The code is commented at most places to explain the working. Here is a short summary:

1. `hhr_extract_alignment` (and the similar `fasta_extract_alignment`): Input a `.hhr` file (output of an HHpred run) and an appropriate PDB (required to know what residues have structure available) and it outputs a MODELLER-ready alignment file. Internally imports from the file `hhr_reader_modified`.  Currently has `hetatm=True`
2. `pdb_info_extract`: Input a PDB and outputs data on the residues corresponding to SEQRES and ATOM records (along with missing residues) -> provides only a summary, not directly used.
3. `collate_alignments`: Join different MODELLER-ready sequences from different `.ali` files into a single `.ali` file as chains to model with a multi-chain PDB template
4. `run_modeller_automodel`, `run_modeller_automodel_selective`, `run_modeller_loopmodel`: variants of running MODELLER with different run parameters

All the remaining scripts are auxiliary/helper scripts and not directly used in the pipeline (see in-file comments for their functions)
